<!-- home.html -->

{% load static %}

<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Ferremas</title>

    <!-- .css -->
    <link rel="stylesheet" href="{% static '/styles/nav.css' %}" />
    <link rel="stylesheet" href="{% static '/styles/loginmodal.css' %}" />
    <link rel="stylesheet" href="{% static '/styles/carrusel.css' %}" />
    <link rel="stylesheet" href="{% static '/styles/nosotroscontacto.css' %}" />

    <script src="https://maps.googleapis.com/maps/api/js?key=AIzaSyCmNP79anmLXaEtIaBJHIVfuWg6xlbXV3w"></script>

    <script>
      var map;
      var directionsService;
      var directionsRenderer;

      function initMap() {
        // Coordenadas de la ubicación de Ferremas
        var ferremasLocation = { lat: -41.461741, lng: -72.945574 };

        // Inicializar el mapa
        map = new google.maps.Map(document.getElementById("map"), {
          center: ferremasLocation,
          zoom: 15,
        });

        // Marcador para la ubicación de Ferremas
        var ferremasMarker = new google.maps.Marker({
          position: ferremasLocation,
          map: map,
          title: "Ferremas", // Etiqueta del marcador
        });

        // Infowindow para el marcador de Ferremas
        var ferremasInfoWindow = new google.maps.InfoWindow({
          content: "Ferremas", // Contenido del infowindow
        });

        // Agregar evento de clic al marcador para abrir el infowindow
        ferremasMarker.addListener("click", function () {
          ferremasInfoWindow.open(map, ferremasMarker);
        });

        // Inicializar el servicio de direcciones
        directionsService = new google.maps.DirectionsService();
        directionsRenderer = new google.maps.DirectionsRenderer();
        directionsRenderer.setMap(map);
      }

      function calculateAndDisplayRoute() {
        if (navigator.geolocation) {
          navigator.geolocation.getCurrentPosition(
            function (position) {
              var pos = {
                lat: position.coords.latitude,
                lng: position.coords.longitude,
              };

              // Calcular y mostrar la ruta desde la ubicación actual del usuario hasta Ferremas
              directionsService.route(
                {
                  origin: pos,
                  destination: { lat: -41.461741, lng: -72.945574 },
                  travelMode: "DRIVING",
                },
                function (response, status) {
                  if (status === "OK") {
                    directionsRenderer.setDirections(response);
                  } else {
                    window.alert("No se pudo calcular la ruta: " + status);
                  }
                }
              );
            },
            function () {
              // Manejar errores de geolocalización
              handleLocationError(true, map.getCenter());
            }
          );
        } else {
          // El navegador no soporta geolocalización
          handleLocationError(false, map.getCenter());
        }
      }

      function handleLocationError(browserHasGeolocation, pos) {
        // Manejar errores de geolocalización
        console.log(
          browserHasGeolocation
            ? "Error: La geolocalización ha fallado."
            : "Error: Tu navegador no soporta geolocalización."
        );
      }
    </script>
  </head>

  <body>
    <!-- barra de navegacion -->
    <header>
      <nav>
        <div class="navbar">
          <div class="logo">
            <a href="/">
              <img src="{% static '/logo/LogoFerremas.png' %}" alt="Logo" />
            </a>
          </div>

          <div class="nav-items">
            <ul>
              <li><a href="#sobrenosotros-container">Nosotros</a></li>
              <li><a href="#contacto-container">Contacto</a></li>
              <li class="login-button">
                <a href="#" id="openLoginModal">Iniciar sesión</a>
              </li>
            </ul>
          </div>
        </div>
      </nav>
    </header>

    <h1>xd</h1>

    <!-- Carrusel -->
    <div class="carousel-container" style="padding-top: 35px">
      <div class="carousel-slide fade">
        <img src="{% static 'slides/slide1.png' %}" alt="Slide 1" />
        <div class="text">Tu ferreteria de confianza, siempre contigo.</div>
      </div>
      <div class="carousel-slide fade">
        <img src="{% static 'slides/slide2.png' %}" alt="Slide 2" />
      </div>
      <div class="carousel-slide fade">
        <img src="{% static 'slides/slide3.png' %}" alt="Slide 3" />
      </div>

      <!-- Botones de navegación -->
      <a class="prev" onclick="plusSlides(-1)">&#10094;</a>
      <a class="next" onclick="plusSlides(1)">&#10095;</a>
    </div>

    <br />

    <!-- Sección Nosotros -->
    <section
      id="sobrenosotros-container"
      class="about-us"
      style="padding-top: 150px"
    >
      <div class="about-us-text">
        <h2>Sobre Nosotros</h2>
        <p>
          Ferremas es tu ferretería de confianza, ofreciendo una amplia variedad
          de herramientas y materiales de construcción de alta calidad. Nuestro
          objetivo es proporcionarte todo lo que necesitas para tus proyectos,
          ya sean grandes o pequeños. Visítanos en nuestra tienda o explora
          nuestra oferta en línea para encontrar exactamente lo que buscas.
        </p>
      </div>
      <div class="about-us-map">
        <!-- Agrega esto en el cuerpo de tu HTML -->
        <h2>¡Estamos aquí!</h2>
        <div id="map" style="height: 400px"></div>

        <h2>¿Cómo llegar desde mi ubicación actual?</h2>
        <button onclick="calculateAndDisplayRoute()">
          Cómo llegar desde mi ubicación actual
        </button>
      </div>
    </section>

    <br />

    <!-- Sección Contacto -->
    <section id="contacto-container" class="contacto">
      <h2>Contacto</h2>
      <p>
        ¿Tienes alguna pregunta o comentario? ¡Déjanos tu correo electrónico y
        nos pondremos en contacto contigo!
      </p>
      <form id="contact-form" action="#" method="post">
        <input
          type="email"
          id="email"
          name="email"
          placeholder="Tu correo electrónico"
          required
        />
        <button type="submit">Enviar</button>
      </form>
      <div id="response-message"></div>
    </section>

    <!-- Login Modal -->
    <div id="loginModal" class="modal">
      <div class="modal-content">
        <span class="close" id="closeLoginModal">&times;</span>
        <img
          src="{% static 'logo/LogoFerremas.png' %}"
          alt="Logo"
          style="
            display: block;
            margin: 0 auto 20px auto;
            width: 150px;
            border-radius: 50%;
          "
        />
        <h2>Iniciar sesión</h2>
        <form method="post" action="{% url 'login_view' %}">
          {% csrf_token %}
          <div class="form-group">
            <label for="email">Correo electrónico</label>
            <input type="email" id="email" name="email" required />
          </div>
          <div class="form-group">
            <label for="password">Contraseña</label>
            <input type="password" id="password" name="password" maxlength="20" required />
          </div>
          <button type="submit">Iniciar sesión</button>
        </form>
        <hr />
        <p>
          ¿No tienes una cuenta?
          <a href="#" id="openRegisterModal">Crear cuenta</a>
        </p>
      </div>
    </div>

    <!-- Register Modal -->
    <div id="registerModal" class="modal">
      <div class="modal-content">
        <span class="close" id="closeRegisterModal">&times;</span>
        <img
          src="{% static 'logo/LogoFerremas.png' %}"
          alt="Logo"
          style="
            display: block;
            margin: 0 auto 20px auto;
            width: 150px;
            border-radius: 50%;
          "
        />
        <h2>Crear cuenta</h2>
        <form method="post" action="{% url 'crear_cuenta' %}">
          {% csrf_token %}
          <div class="form-group">
            <label for="reg_cli_rut">RUT</label>
            <input
              type="text"
              id="reg_cli_rut"
              name="cli_rut"
              required
              maxlength="12"
              pattern="^\d{1,2}\.\d{3}\.\d{3}-[0-9kK]{1}$"
              title="El RUT debe tener el formato correcto, como 11.222.333-4 o 1.222.333-4"
            />
          </div>
          <div class="form-group">
            <label for="reg_cli_name">Nombre</label>
            <input type="text" id="reg_cli_name" name="cli_name" maxlength="20" required />
          </div>
          <div class="form-group">
            <label for="reg_cli_lastname">Apellido</label>
            <input
              type="text"
              id="reg_cli_lastname"
              name="cli_lastname"
              maxlength="20"
              required
            />
          </div>
          <div class="form-group">
            <label for="reg_email">Correo electrónico</label>
            <input type="email" id="reg_email" name="cli_mail" required />
          </div>
          <div class="form-group">
            <label for="reg_password">Contraseña</label>
            <input
              type="password"
              id="reg_password"
              name="cli_password"
              maxlength="20"
              required
            />
          </div>
          <div class="form-group">
            <label for="reg_fono">Teléfono</label>
            <input type="text" id="reg_fono" name="cli_fono" required />
          </div>
          <button type="submit">Crear cuenta</button>
        </form>
      </div>
    </div>

    <script src="{% static 'js/loginmodal.js' %}"></script>
    <script src="{% static 'js/carrusel.js' %}"></script>
    <script src="{% static 'js/contacto.js' %}"></script>

    <script>
      // Llamar a la función initMap() cuando la página se cargue
      google.maps.event.addDomListener(window, "load", initMap);
    </script>
  </body>
</html>
